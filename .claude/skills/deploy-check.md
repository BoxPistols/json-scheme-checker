# デプロイ前チェック

このスキルは、Vercelへのデプロイ前に必要な全ての確認を行います。

## 実行内容

あなたはデプロイメントエンジニアです。本番環境へのデプロイ前に以下の項目を包括的にチェックしてください：

### 1. 環境設定の確認

- .env.example が最新の環境変数を反映しているか
- vercel.json の設定が適切か
- 環境変数の命名規則が統一されているか
- 機密情報が誤ってコミットされていないか

### 2. 依存関係の確認

- package.json の dependencies と devDependencies が適切に分類されているか
- 未使用のパッケージがないか
- パッケージのバージョンに脆弱性がないか
- pnpm-lock.yaml が最新か

### 3. ビルドとテストの確認

- pnpm start でローカル起動できるか
- pnpm lint でエラーがないか
- 全てのAPIエンドポイントが正常に動作するか

### 4. Vercel設定の確認

- serverless functions の設定が適切か
- タイムアウト設定が適切か
- CORS設定が本番環境に適しているか
- レート制限が有効化されているか

### 5. セキュリティチェック

- APIキーのハードコーディングがないか
- CORS設定が適切か（ワイルドカード使用の確認）
- 入力検証が全てのエンドポイントで実装されているか
- レート制限が適切に設定されているか

### 6. ドキュメントの確認

- README.md が最新の機能を反映しているか
- .ai-docs/ 配下のドキュメントが更新されているか
- CLAUDE.md が最新の開発フローを反映しているか

### 7. パフォーマンスチェック

- 不要なconsole.logが削除されているか
- 大きなファイルサイズの問題がないか
- メモリリークの可能性がないか

## 実行手順

1. 各チェック項目を順番に確認
2. 問題があれば重大度を判定
3. デプロイ可否を判断
4. 改善が必要な項目をリストアップ

## 出力形式

```markdown
# デプロイ前チェック結果

## デプロイ判定

**結果**: [OK / 要改善 / デプロイ不可]

## チェックサマリ

- 環境設定: [OK / NG]
- 依存関係: [OK / NG]
- ビルド・テスト: [OK / NG]
- Vercel設定: [OK / NG]
- セキュリティ: [OK / NG]
- ドキュメント: [OK / NG]
- パフォーマンス: [OK / NG]

## 詳細レポート

### ブロッカー（デプロイ前に必ず対応が必要）

1. [問題点]
   - 場所: [ファイル名:行数]
   - 理由: [なぜブロッカーなのか]
   - 対応方法: [具体的な修正方法]

### 警告（できるだけ早く対応すべき）

1. [問題点]
   - 場所: [ファイル名:行数]
   - 理由: [なぜ警告なのか]
   - 対応方法: [具体的な修正方法]

### 推奨（時間があれば対応）

1. [改善提案]
   - 理由: [なぜ推奨するのか]
   - 対応方法: [具体的な実装方法]

## デプロイ手順

[ブロッカーがない場合のデプロイ手順を記載]

1. [手順1]
2. [手順2]
   ...

## デプロイ後の確認項目

- [ ] 本番環境で全てのエンドポイントが動作するか
- [ ] エラーログに異常がないか
- [ ] レート制限が正常に機能しているか
```

## 注意事項

- 絵文字は使用しないでください
- 実際にファイルを確認し、具体的な証拠に基づいて判断してください
- セキュリティ上の問題は特に厳しくチェックしてください
- デプロイ判定は保守的に行ってください（疑わしい場合は要改善）
