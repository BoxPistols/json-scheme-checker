# モデル選定と料金ガイド（2025-10-21 時点・要更新）

このドキュメントは、本サービスで表示する「API消費量/料金」の算出に関わるモデル選定と単価の管理方法をまとめたものです。実料金は常に変動するため、最新の公式情報で必ず更新・確認してください。

重要: ここに記載の単価は参考値です。必ず公式価格表の最新情報で上書きしてください。

---

## 1. 主なモデル（カテゴリ別）

- GPT-5 系（2025年8月7日リリース・最新世代）
  - gpt-5-nano, gpt-5-mini, gpt-5
  - 特徴: 超低レイテンシ、最小限の推論、リアルタイムアプリケーション向け
  - 料金: 設定済み（下記参照）
  - 注意: temperature, top_p, frequency_penalty, presence_penalty パラメータは非対応

- GPT-4.x 系（引き続き利用ニーズあり）
  - gpt-4.1, gpt-4.1-mini
  - gpt-4o, gpt-4.1-nano
  - 特徴: 実績と安定性。多くの既存ワークロードで実運用

- o 系（推論最適化）
  - o3, o3-mini
  - 特徴: コスト/速度に最適化された世代

---

## 2. 参考料金（暫定・USD/トークン）

> 参考の初期値。必ず最新情報に置き換えてください。

| モデル       | 入力単価(USD/token) | 出力単価(USD/token) | 用途目安           |
| ------------ | ------------------: | ------------------: | ------------------ |
| gpt-5-nano   |          0.00000005 |          0.00000040 | 超低レイテンシ     |
| gpt-5-mini   |          0.00000030 |          0.00000150 | バランス型（推定） |
| gpt-5        |          0.00000125 |          0.00001000 | 高品質             |
| gpt-4.1-nano |          0.00000015 |          0.00000060 | 高頻度/軽量        |
| gpt-4o       |          0.00000250 |          0.00001000 | 高品質汎用         |
| gpt-4.1-mini |          0.00000015 |          0.00000060 | 軽量4.1系          |
| gpt-4.1      |          0.00000300 |          0.00001500 | 高品質4.1系        |
| o3-mini      |          0.00000060 |          0.00000240 | 低コスト重視       |
| o3           |          0.00000300 |          0.00001500 | バランス           |

JPY換算の例: 本サービスでは 1 USD = 150 JPY（固定換算、コード内で変更可）

---

## 3. 本サービスでのモデル選択/単価反映の仕組み

- フロント（レビュー画面ヘッダー）に「モデル」セレクトを設置
  - 保存キー: `jsonld_model_blog_reviewer`
  - 選択即時に単価切替 -> ヘッダーの「本回/累計」および最下部の料金パネルを再計算
- サーバー側が使用したモデル名をSSEで先送信
  - 受信時に自動でセレクト・単価へ反映（ユーザ選択 > 自動推定の優先度は要件に合わせて調整可）

---

## 4. 料金テーブル更新手順

1. 単価定義の更新（フロント）
   - ファイル: `public/modules/blog-reviewer.js`
   - 関数: `getModelPricing(model)`
   - ここで対象モデルの `input` / `output` 単価（USD/token）を更新

2. セレクト候補の更新（必要時）
   - 同ファイルのレビュー画面ヘッダー内 `<select id="blogReviewerModelSelect">` の候補を追加/削除

3. デフォルトモデルの変更（必要時）
   - `getSelectedModel()` の既定値、または `localStorage` の値を調整
   - サーバーの既定モデルは環境変数 `OPENAI_MODEL`（`server.js` / API内参照）

---

## 5. モデル自動判定（拡張案）

- すでに API からは実使用モデル名をSSEで通知
- 追加で「クライアントの選択 > サーバーの実使用名」の優先ロジックや、
  過去実績からの推定、失敗時のフォールバック（mini系へ）などの戦略を設計可能

---

## 6. 注意事項（2025-11-02 更新）

- 本ドキュメントは 2025-11-02 時点の情報をもとに作成しています。
- 料金/ラインナップ/命名は随時変動します。必ず最新の公式ドキュメントで確認のうえ更新してください。
- 表の単価は参考値です。運用前に必ず正確な単価で差し替えてください。

### GPT-5 シリーズ利用時の重要な制限事項

GPT-5 シリーズ（gpt-5、gpt-5-mini、gpt-5-nano）では、以下のパラメータがサポートされていません：

- `temperature`: デフォルト値（1）のみサポート。他の値を指定すると400エラーが発生
- `top_p`: 制限あり
- `frequency_penalty`: 制限あり
- `presence_penalty`: 制限あり

本サービスのバックエンド（api/advisor.js、api/web-advisor.js、api/blog-reviewer.js）では、モデル名が`gpt-5`で始まる場合、自動的に`temperature`パラメータを除外する実装が完了しています。

### モデル選択時の推奨事項

- **既定モデル**: gpt-5-nano（標準、レイテンシ重視）
- **コスト重視**: gpt-4.1-nano（最も安価、温度調整可能）
- **レイテンシ重視**: gpt-5-nano（超低レイテンシ、温度調整不可）
- **品質重視**: gpt-4o または gpt-5（高品質、コスト高）
- **バランス重視**: gpt-4.1-mini または gpt-5-mini

### gpt-4.1-nano と gpt-5-nano の比較

| 項目                       | gpt-4.1-nano           | gpt-5-nano                   |
| -------------------------- | ---------------------- | ---------------------------- |
| **リリース日**             | 2025年4月14日          | 2025年8月7日                 |
| **入力料金**               | $0.10/1M トークン      | $0.05/1M トークン            |
| **出力料金**               | $0.40/1M トークン      | $0.40/1M トークン            |
| **コンテキストウィンドウ** | 100万トークン          | 40万トークン                 |
| **推論性能**               | 標準                   | 高（推論能力向上）           |
| **レイテンシ**             | 標準                   | 超低レイテンシ               |
| **temperature対応**        | 対応                   | 非対応（デフォルト値1のみ）  |
| **推奨用途**               | コスト重視、高頻度利用 | リアルタイム応答、低遅延重視 |

### MyAPIの利用が必須なモデル

既定のサーバーAPIキーでは、以下のモデルのみ利用可能です：

- **gpt-5-nano** （既定）
- **gpt-4.1-nano**

以下のモデルを使用するには、**MyAPIモード（独自のOpenAI APIキー）が必須**です：

- gpt-5
- gpt-5-mini
- gpt-4.1
- gpt-4.1-mini
- gpt-4o
- gpt-4o-mini
- gpt-3.5-turbo
- o3
- o3-mini

MyAPIモードの設定方法：

1. ヘッダーの「My API」ボタンをクリック
2. 独自のOpenAI APIキーを入力
3. 使用したいモデルを選択
4. 保存
